!function(n){"use strict";n.CustomTemplate={};var a=Math.ceil(15*n.innerHeight/100),s=Modernizr.csstransitions,i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[Modernizr.prefixed("transition")],c=function(t,e){var n=function(t){if(s){if(t.target!=this)return;this.removeEventListener(i,n)}e&&"function"==typeof e&&e.call(this)};s?t.addEventListener(i,n):n()},l=document.querySelector(".pages-stack"),d=[].slice.call(l.children),r=d.length,u=function(){for(var t=0,e=0;e<r;++e)if(-1!=n.location.href.indexOf("/"+d[e].getAttribute("id"))){t=e;break}return t}(),f=document.querySelector("button.menu-button"),p=document.querySelector(".pages-nav"),t=[].slice.call(p.querySelectorAll(".link--page")),m=!1;function v(){for(var t=g(),e=0;e<r;++e){var n=d[e],s=t.indexOf(e);u!==e?(n.classList.add("page--inactive"),-1!==s?(n.style.WebkitTransform="translate3d(0,100%,0)",n.style.transform="translate3d(0,100%,0)"):(n.style.WebkitTransform="translate3d(0,75%,"+parseInt(-100-a*e)+"px)",n.style.transform="translate3d(0,75%,"+parseInt(-100-a*e)+"px)")):n.classList.remove("page--inactive"),n.style.zIndex=e<u?parseInt(u-e):parseInt(r+u-e),n.style.opacity=-1!==s?parseFloat(1-.1*s):0}}function e(){m?o():(function(){f.classList.add("menu-button--open"),l.classList.add("pages-stack--open"),p.classList.add("pages-nav--open");for(var t=g(),e=0,n=t.length;e<n;++e){var s=d[t[e]];s.style.WebkitTransform="translate3d(0, 75%, "+parseInt(-100-a*e)+"px)",s.style.transform="translate3d(0, 75%, "+parseInt(-100-a*e)+"px)"}}(),m=!0)}function o(){y()}function y(t,e){t&&-1!==t.indexOf("#")&&(t=t.substr(0,t.indexOf("#")));var n=t?document.getElementById(t):d[u],s=d.indexOf(n),a=g(s);n.style.cssText="opacity: 1";for(var i=0,r=a.length;i<r;++i){var o=d[a[i]];o.style.WebkitTransform="translate3d(0,100%,0)",o.style.transform="translate3d(0,100%,0)"}t&&(u=s),void 0!==e&&e?v():(f.classList.remove("menu-button--open"),p.classList.remove("pages-nav--open"),c(n,function(){l.classList.remove("pages-stack--open"),v(),m=!1}))}function g(t){var e=u+1<r?u+1:0,n=u+2<r?u+2:1,s=[];return t!=u&&s.push(u),t!=e&&s.push(e),t!=n&&s.push(n),s}n.CustomTemplate.closeMenu=o,n.CustomTemplate.openPage=y,v(),f.addEventListener("click",e),t.forEach(function(t){t.addEventListener("click",function(t){y("page-root",void 0)})}),d.forEach(function(t){t.getAttribute("id");t.addEventListener("click",function(t){})}),document.addEventListener("keydown",function(t){m&&27===(t.keyCode||t.which)&&o()})}(window);